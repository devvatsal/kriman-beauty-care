!function(t){function a(){t.ajax({url:h,cache:!1}).done((function(t){b.html('<div class="vbox-inline">'+t+"</div>"),r()})).fail((function(){b.html('<div class="vbox-inline"><p>Error retrieving contents, please retry</div>'),r()}))}function e(){b.html('<iframe class="venoframe" src="'+h+'"></iframe>'),r()}function o(t){var a=h.split("/"),e=a[a.length-1],o=t?"?autoplay=1":"";b.html('<iframe class="venoframe" webkitallowfullscreen mozallowfullscreen allowfullscreen frameborder="0" src="//player.vimeo.com/video/'+e+o+'"></iframe>'),r()}function i(t){var a=h.split("/"),e=a[a.length-1],o=t?"?autoplay=1":"";b.html('<iframe class="venoframe" webkitallowfullscreen mozallowfullscreen allowfullscreen src="//www.youtube.com/embed/'+e+o+'"></iframe>'),r()}function n(){b.html('<div class="vbox-inline">'+t(h).html()+"</div>"),r()}function l(){t(".vbox-content").find("img").one("load",(function(){r()})).each((function(){this.complete&&t(this).load()}))}function r(){v.html(z),b.find(">:first-child").addClass("figlio"),t(".figlio").css("width",g).css("height",x).css("padding",f).css("background",c),P=b.outerHeight(),(L=t(window).height())>P+80?(k=(L-P)/2,b.css("margin-top",k),b.css("margin-bottom",k)):(b.css("margin-top","40px"),b.css("margin-bottom","40px")),b.animate({opacity:"1"},"slow")}var d,c,s,v,f,m,b,h,u,g,x,p,y,w,k,C,j,q,z,H,D,E,L,P,Q,X;t.fn.extend({venobox:function(r){var k=t.extend({framewidth:"",frameheight:"",border:"0",bgcolor:"#fff",titleattr:"title",numeratio:!1,infinigall:!1,overlayclose:!0},r);return this.each((function(){var r=t(this);return!!r.data("venobox")||(r.addClass("vbox-item"),r.data("framewidth",k.framewidth),r.data("frameheight",k.frameheight),r.data("border",k.border),r.data("bgcolor",k.bgcolor),r.data("numeratio",k.numeratio),r.data("infinigall",k.infinigall),r.data("overlayclose",k.overlayclose),r.data("venobox",!0),void r.click((function(L){function P(){H=r.data("gall"),C=r.data("numeratio"),p=r.data("infinigall"),(y=t('.vbox-item[data-gall="'+H+'"]')).length>1&&!0===C?(s.html(y.index(r)+1+" / "+y.length),s.show()):s.hide(),D=y.eq(y.index(r)+1),E=y.eq(y.index(r)-1),r.attr(k.titleattr)?(z=r.attr(k.titleattr),v.show()):(z="",v.hide()),y.length>1&&!0===p?(Q=!0,X=!0,D.length<1&&(D=y.eq(0)),y.index(r)<1&&(E=y.eq(y.index(y.length)))):(D.length>0?(t(".vbox-next").css("display","block"),Q=!0):(t(".vbox-next").css("display","none"),Q=!1),y.index(r)>0?(t(".vbox-prev").css("display","block"),X=!0):(t(".vbox-prev").css("display","none"),X=!1))}function A(t){27===t.keyCode&&B()}function B(){t("body").removeClass("vbox-open"),t("body").unbind("keydown",A),q.animate({opacity:0},500,(function(){q.remove(),w=!1,r.focus()}))}L.stopPropagation(),L.preventDefault(),r=t(this),j=r.data("overlay"),g=r.data("framewidth"),x=r.data("frameheight"),d=r.data("autoplay")||!1,f=r.data("border"),c=r.data("bgcolor"),Q=!1,X=!1,w=!1,h=r.data("href")||r.attr("href"),u=r.data("css")||"",t("body").addClass("vbox-open"),m='<div class="vbox-overlay '+u+'" style="background:'+j+'"><div class="vbox-preloader">Loading...</div><div class="vbox-container"><div class="vbox-content"></div></div><div class="vbox-title"></div><div class="vbox-num">0/0</div><div class="vbox-close">X</div><div class="vbox-next">next</div><div class="vbox-prev">prev</div></div>',t("body").append(m),q=t(".vbox-overlay"),t(".vbox-container"),b=t(".vbox-content"),s=t(".vbox-num"),v=t(".vbox-title"),b.html(""),b.css("opacity","0"),P(),q.css("min-height",t(window).outerHeight()),q.animate({opacity:1},250,(function(){"iframe"==r.data("type")?e():"inline"==r.data("type")?n():"ajax"==r.data("type")?a():"vimeo"==r.data("type")?o(d):"youtube"==r.data("type")?i(d):(b.html('<img src="'+h+'">'),l())}));var F=function(){w||(w=!0,j=E.data("overlay"),g=E.data("framewidth"),x=E.data("frameheight"),f=E.data("border"),c=E.data("bgcolor"),h=E.data("href")||E.attr("href"),d=E.data("autoplay"),z=E.attr(k.titleattr)?E.attr(k.titleattr):"",void 0===j&&(j=""),b.animate({opacity:0},500,(function(){q.css("background",j),"iframe"==E.data("type")?e():"inline"==E.data("type")?n():"ajax"==E.data("type")?a():"youtube"==E.data("type")?i(d):"vimeo"==E.data("type")?o(d):(b.html('<img src="'+h+'">'),l()),r=E,P(),w=!1})))},G=function(){w||(w=!0,j=D.data("overlay"),g=D.data("framewidth"),x=D.data("frameheight"),f=D.data("border"),c=D.data("bgcolor"),h=D.data("href")||D.attr("href"),d=D.data("autoplay"),z=D.attr(k.titleattr)?D.attr(k.titleattr):"",void 0===j&&(j=""),b.animate({opacity:0},500,(function(){q.css("background",j),"iframe"==D.data("type")?e():"inline"==D.data("type")?n():"ajax"==D.data("type")?a():"youtube"==D.data("type")?i(d):"vimeo"==D.data("type")?o(d):(b.html('<img src="'+h+'">'),l()),r=D,P(),w=!1})))};t("body").keydown((function(t){37==t.keyCode&&1==X&&F(),39==t.keyCode&&1==Q&&G()})),t(".vbox-prev").click((function(){F()})),t(".vbox-next").click((function(){G()}));var I=".vbox-close, .vbox-overlay";return r.data("overlayclose")||(I=".vbox-close"),t(I).click((function(a){".figlio",".vbox-prev",".vbox-next",".figlio *",t(a.target).is(".figlio")||t(a.target).is(".vbox-next")||t(a.target).is(".vbox-prev")||t(a.target).is(".figlio *")||B()})),t("body").keydown(A),!1})))}))}}),t(window).resize((function(){t(".vbox-content").length&&(P=b.height(),(L=t(window).height())>P+80?(k=(L-P)/2,b.css("margin-top",k),b.css("margin-bottom",k)):(b.css("margin-top","40px"),b.css("margin-bottom","40px")))}))}(jQuery);